{"ast":null,"code":"import React from'react';import{useState,useEffect}from'react';import Post from'../post/Post';import Share from'../share/Share';import axios from\"axios\";import{useContext}from\"react\";import{AuthContext}from\"../../context/AuthContext\";import{withStyles}from'@material-ui/core/styles';import{styles}from'./feedStyle';import InfiniteScroll from\"react-infinite-scroll-component\";import Loader from\"../loader/loader\";import LoadingBar from\"react-top-loading-bar\";import{useMediaQuery}from'react-responsive';import{useRef}from'react';import{regSw,subscribe}from'../../helper.js';import{io}from'socket.io-client';import Button from'@mui/material/Button';import Dialog from'@mui/material/Dialog';import DialogActions from'@mui/material/DialogActions';import DialogContent from'@mui/material/DialogContent';import DialogContentText from'@mui/material/DialogContentText';import DialogTitle from'@mui/material/DialogTitle';import Slide from'@mui/material/Slide';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const Transition=/*#__PURE__*/React.forwardRef(function Transition(props,ref){return/*#__PURE__*/_jsx(Slide,{direction:\"up\",ref:ref,...props});});function Feed(_ref){let{username,classes,selectedValue,searchTerm}=_ref;const[posts,setPosts]=useState([]);const[hasMore,setHasMore]=useState(true);const[index,setIndex]=useState(0);const[isFiltered,setIsFiltered]=useState(false);const[preFilter,setPreFilter]=useState(-1);const[progress,setProgress]=useState(0);const[preProfile,setPreProfile]=useState(\" \");const[viewedPosts,setViewedPosts]=useState([]);const{user:currentUser}=useContext(AuthContext);const isMobileDevice=useMediaQuery({query:\"(min-device-width: 480px)\"});const isTabletDevice=useMediaQuery({query:\"(min-device-width: 768px)\"});const[socket,setSocket]=useState(null);const[open,setOpen]=React.useState(false);let postCallCount=0;let maxCalls=5;const handleClickOpen=()=>{setOpen(true);};const handleClose=()=>{setOpen(false);continueProcess(0);setPosts(prevPosts=>prevPosts.slice(1));};const handleYes=async e=>{setOpen(false);const firstPost=posts[0];setTimeout(()=>{setPosts(prevPosts=>prevPosts.slice(1));},1000);const token=localStorage.getItem('token');const newPost={userId:user._id,desc:firstPost.desc,thumb:firstPost.thumb,pool:user.pool,headers:{'auth-token':token}};try{const pst=await axios.post(\"/posts/\"+user._id+\"/create\",newPost);socket.emit('sendMessage',pst);await axios.post(\"/posts/UserReadSpecialPost\",{\"postId\":firstPost._id,\"userId\":user._id,headers:{'auth-token':token}});continueProcess(10000);postCallCount++;}catch(err){console.log(err);}};const continueProcess=dlay=>{if(postCallCount<maxCalls){// Call showPostsInOrder again after 60 seconds\nsetTimeout(()=>{showPostsInOrder();// Continue the process by checking the condition in handleYes\nif(postCallCount<maxCalls){setTimeout(()=>{//handleYes();\n},5000);// Wait 20 seconds after showPostsInOrder for handleYes\n}},dlay);// 60000 milliseconds = 60 seconds\n}else{console.log(\"Process stopped after 5 calls.\");}};const[windowSize,setWindowSize]=useState(getWindowSize());//useEffect(() => {\n//console.log(\"setSocket\");\n//setSocket(io('wss://cleopatra.ijs.si/chat', {\n//   transports: [ 'polling'],\n//    withCredentials: true\n//  }));\n//}, [])\nuseEffect(()=>{console.log('Posts updated: ',posts);},[posts]);useEffect(()=>{socket===null||socket===void 0?void 0:socket.emit('addUser',user===null||user===void 0?void 0:user.id);console.log(\"active users \");socket===null||socket===void 0?void 0:socket.on('getUsers',users=>{console.log(\"active users \",users);});socket===null||socket===void 0?void 0:socket.on('getMessage',res=>{console.log('active data: >>',res.data);if(res.data.pool==user.pool){const arr=[res.data];setPosts(prevItems=>[...arr,...prevItems]);console.log('posts data: >>',posts);}//fetchPosts(selectedValue); \n});},[socket]);const showPostsInOrder=async()=>{const token=localStorage.getItem('token');console.log(\"showPostsInOrder\");const res=await axios.get(\"/posts/\"+currentUser._id+\"/getSpecialPosts\",{headers:{'auth-token':token}});console.log(res.data);if(res.data['no']){const arr=[{\"_id\":res.data[\"_id\"],\"desc\":res.data[\"desc\"],\"pool\":res.data[\"pool\"],\"userId\":\"66f590ae38f16e2cea8d0646\",\"thumb\":\"https://fastly.picsum.photos/id/451/200/300.jpg?blur=5&hmac=Cs_EydLmPTWdSMrzBl8vXIG9b3CaH9iP_yVdDFiXUhU\",\"likes\":[],\"dislikes\":[],\"comments\":[],\"reposts\":[],\"rank\":1000}];setPosts(prevItems=>[...arr,...prevItems]);console.log('posts data: >>',posts);//postCallCount++;\nsetTimeout(handleClickOpen,5000);}};const increment=async(pv,iv)=>{console.log(\"increatem\");console.log(pv);console.log(iv);setIndex(pv+iv);console.log(index);};/*async function registerAndSubscribe () {\n    try {\n        const serviceWorkerReg = await regSw ();\n        await subscribe (serviceWorkerReg);\n    } catch (error) {\n        console.log (error);\n    }\n}*/const{user}=useContext(AuthContext);const[followed,setFollowed]=useState([]//currentUser.followings.includes(user?.id)\n);if(preFilter==-1){console.log(preFilter);setPreFilter(selectedValue);}else if(preFilter!==selectedValue){setIndex(0);setPosts([]);setPreFilter(selectedValue);}const chek=username?true:false;if(chek==true){console.log(preProfile);console.log(\"User name1\");console.log(username);const ii=preProfile===username?true:false;console.log(ii);if(preProfile===\" \"){setPreProfile(username);console.log(\"User name2\");console.log(username);console.log(preProfile);console.log(user.username);}else if(preProfile!==username){console.log(\"a NEW User name\");console.log(username);setIndex(0);setPosts([]);setPreProfile(username);}}const filterLoadedPosts=async()=>{console.log(\"filterLoadedPosts\");if(searchTerm===''){setPosts(posts);}else{const filteredData=posts.filter(post=>{return post.desc.toLowerCase().includes(searchTerm.toLowerCase());});setPosts(filteredData);}};const fetchPosts=async selectedValue=>{setProgress(30);console.log(\"fetchpost\");const chek=username?true:false;if(chek==true){console.log(preProfile);console.log(\"User name1\");console.log(username);const ii=preProfile===username?true:false;console.log(ii);if(preProfile===\" \"){setPreProfile(username);console.log(\"User name2\");console.log(username);console.log(preProfile);console.log(user.username);}else if(preProfile!==username){console.log(\"a NEW User name\");console.log(username);setIndex(0);setPosts([]);setPreProfile(username);}}var whPosts=\"/posts/timelinePag/\";if(selectedValue==0){var whPosts=\"/posts/timelinePag/\";}else if(selectedValue==1){whPosts=\"/posts/onlyFollowersPag/\";}else if(selectedValue==2){whPosts=\"/posts/onlyFollowingsPag/\";}console.log(preFilter);console.log(whPosts);const token=localStorage.getItem('token');const res=username?await axios.get(\"/posts/profile/\"+username+\"?page=\".concat(index),{headers:{'auth-token':token,'userId':user._id}}):await axios.get(whPosts+user._id+\"?page=\".concat(index),{headers:{'auth-token':token,'userId':user._id}});console.log(res.data);console.log(\"fetch posts\");if(res.data.length){if(res.data.length>0){setPosts(prevItems=>[...prevItems,...res.data//.sort((p1,p2) => {return new Date(p2.createdAt) - new Date(p1.createdAt);})\n]);res.data.length%20>0?setHasMore(false):setHasMore(true);//setIndex((index) => index + 1);\nincrement(index,1);setProgress(100);}else{setHasMore(false);setProgress(100);//setPosts([]);\n//setIndex((index) => 0);\n//increment(index, -index);\n}//setPreFilter(whPosts);\nconsole.log(whPosts);//setPosts(res.data.sort((p1,p2) => {return new Date(p2.createdAt) - new Date(p1.createdAt);})); \n}};function updateViewdPosts(post){/*const oldViewed = [...viewedPosts, post];\n    setViewedPosts(oldViewed);\n    console.log(\"array  \", viewedPosts);\n    console.log(\"post id  \", post);\n    console.log(\"viewed length \", viewedPosts.length);\n    if(viewedPosts.length == 10){\n        axios.put(\"/users/\" + currentUser._id + \"/viewed\", { postId: post });\n        setViewedPosts([]);\n    }*/}const fetchMoreData=async()=>{setProgress(30);if(searchTerm?searchTerm.length!==0:false){console.log(\"searchTerm\");console.log(searchTerm.length);setProgress(100);return;}if(index==0){setProgress(100);return;}//console.log(\"fetchpost\")\nconsole.log(\"fetch more  posts\");console.log(selectedValue);var whPosts=\"/posts/timelinePag/\";if(selectedValue==0){whPosts=\"/posts/timelinePag/\";}else if(selectedValue==1){whPosts=\"/posts/onlyFollowersPag/\";}else if(selectedValue==2){whPosts=\"/posts/onlyFollowingsPag/\";}const token=localStorage.getItem('token');const res=username?await axios.get(\"/posts/profile/\"+username+\"?page=\".concat(index),{headers:{'auth-token':token}}):await axios.get(whPosts+user._id+\"?page=\".concat(index),{headers:{'auth-token':token}});//console.log(res.data);\nif(res.data.length>0){setPosts(prevItems=>[...prevItems,...res.data//.sort((p1,p2) => {return new Date(p2.createdAt) - new Date(p1.createdAt);})\n]);res.data.length%20>0?setHasMore(false):setHasMore(true);increment(index,1);setProgress(100);}else{setHasMore(false);setProgress(100);//setPosts([]);\n//setIndex((index) => 0);\n//increment(index, -index);\n}};function getWindowSize(){const{innerWidth,innerHeight}=window;return{innerWidth,innerHeight};};useEffect(()=>{//registerAndSubscribe();\nconsole.log(\"use effects!\");//showPostsInOrder();\nif(selectedValue!=10){///// Remove this breakpoint during the casestudy\n//filterLoadedPosts()\nif(searchTerm?searchTerm.length!==0:false){console.log(\"searchTerm\");console.log(searchTerm.length);filterLoadedPosts();}else{//filterLoadedPosts()\nfetchPosts(selectedValue);}}function handleWindowResize(){setWindowSize(getWindowSize());}window.addEventListener('resize',handleWindowResize);return()=>{window.removeEventListener('resize',handleWindowResize);};},[username,user._id,selectedValue,searchTerm]);const refreshed=async selectedValue=>{console.log(\"refreshed\");setPosts([]);const chek=username?true:false;if(chek==true){console.log(preProfile);console.log(\"User name1\");console.log(username);const ii=preProfile===username?true:false;console.log(ii);if(preProfile===\" \"){setPreProfile(username);console.log(\"User name2\");console.log(username);console.log(preProfile);console.log(user.username);}else if(preProfile!==username){console.log(\"a NEW User name\");console.log(username);setIndex(0);setPosts([]);setPreProfile(username);}}var whPosts=\"/posts/timelinePag/\";if(selectedValue==0){var whPosts=\"/posts/timelinePag/\";}else if(selectedValue==1){whPosts=\"/posts/onlyFollowersPag/\";}else if(selectedValue==2){whPosts=\"/posts/onlyFollowingsPag/\";}console.log(preFilter);console.log(whPosts);const token=localStorage.getItem('token');const res=username?await axios.get(\"/posts/profile/\"+username+\"?page=\".concat(0),{headers:{'auth-token':token}}):await axios.get(whPosts+user._id+\"?page=\".concat(0),{headers:{'auth-token':token}});console.log(res.data);console.log(\"fetch posts\");if(res.data.length){if(res.data.length>0){setPosts(prevItems=>[...prevItems,...res.data//.sort((p1,p2) => {return new Date(p2.createdAt) - new Date(p1.createdAt);})\n]);res.data.length%20>0?setHasMore(false):setHasMore(true);//setIndex((index) => index + 1);\nincrement(0,1);}else{setHasMore(false);//setPosts([]);\n//setIndex((index) => 0);\n//increment(index, -index);\n}//setPreFilter(whPosts);\nconsole.log(whPosts);}};return/*#__PURE__*/_jsxs(\"div\",{className:classes.feed,children:[/*#__PURE__*/_jsx(LoadingBar,{color:\"#f11946\",progress:progress,onLoaderFinished:()=>setProgress(0)}),/*#__PURE__*/_jsx(InfiniteScroll,{dataLength:posts.length,next:fetchMoreData,hasMore:hasMore,loader:/*#__PURE__*/_jsx(Loader,{}),children:/*#__PURE__*/_jsxs(\"div\",{className:classes.feedWrapper,style:{\"width\":!isMobileDevice&&!isTabletDevice&&windowSize.innerWidth-10+\"px\"},children:[!username||username===user.username,posts.map(p=>{return/*#__PURE__*/_jsx(Post,{onScrolling:updateViewdPosts,post:p,isDetail:false},p._id);})]})})]});}export default withStyles(styles)(Feed);","map":{"version":3,"names":["React","useState","useEffect","Post","Share","axios","useContext","AuthContext","withStyles","styles","InfiniteScroll","Loader","LoadingBar","useMediaQuery","useRef","regSw","subscribe","io","Button","Dialog","DialogActions","DialogContent","DialogContentText","DialogTitle","Slide","jsx","_jsx","jsxs","_jsxs","Transition","forwardRef","props","ref","direction","Feed","_ref","username","classes","selectedValue","searchTerm","posts","setPosts","hasMore","setHasMore","index","setIndex","isFiltered","setIsFiltered","preFilter","setPreFilter","progress","setProgress","preProfile","setPreProfile","viewedPosts","setViewedPosts","user","currentUser","isMobileDevice","query","isTabletDevice","socket","setSocket","open","setOpen","postCallCount","maxCalls","handleClickOpen","handleClose","continueProcess","prevPosts","slice","handleYes","e","firstPost","setTimeout","token","localStorage","getItem","newPost","userId","_id","desc","thumb","pool","headers","pst","post","emit","err","console","log","dlay","showPostsInOrder","windowSize","setWindowSize","getWindowSize","id","on","users","res","data","arr","prevItems","get","increment","pv","iv","followed","setFollowed","chek","ii","filterLoadedPosts","filteredData","filter","toLowerCase","includes","fetchPosts","whPosts","concat","length","updateViewdPosts","fetchMoreData","innerWidth","innerHeight","window","handleWindowResize","addEventListener","removeEventListener","refreshed","className","feed","children","color","onLoaderFinished","dataLength","next","loader","feedWrapper","style","map","p","onScrolling","isDetail"],"sources":["/home/group4/TWON_STA_Case_Study/client/src/components/feed/Feed.js"],"sourcesContent":["import React from 'react';\nimport {useState, useEffect} from 'react'\nimport Post from '../post/Post'\nimport Share from '../share/Share'\nimport axios from \"axios\"\nimport { useContext } from \"react\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport { withStyles } from '@material-ui/core/styles';\nimport {styles} from './feedStyle';\nimport InfiniteScroll from \"react-infinite-scroll-component\";\nimport Loader from \"../loader/loader\";\nimport LoadingBar from \"react-top-loading-bar\";\nimport { useMediaQuery } from 'react-responsive';\nimport {useRef} from 'react';\nimport {regSw, subscribe} from '../../helper.js';\nimport {io} from 'socket.io-client';\n\nimport Button from '@mui/material/Button';\nimport Dialog from '@mui/material/Dialog';\nimport DialogActions from '@mui/material/DialogActions';\nimport DialogContent from '@mui/material/DialogContent';\nimport DialogContentText from '@mui/material/DialogContentText';\nimport DialogTitle from '@mui/material/DialogTitle';\nimport Slide from '@mui/material/Slide';\n\nconst Transition = React.forwardRef(function Transition(props, ref) {\n  return <Slide direction=\"up\" ref={ref} {...props} />;\n});\n\n\nfunction Feed({username, classes, selectedValue, searchTerm}) {\nconst [posts, setPosts] = useState([]);\nconst [hasMore, setHasMore] = useState(true);\nconst [index, setIndex] = useState(0);\nconst [isFiltered, setIsFiltered] = useState(false);\nconst [preFilter, setPreFilter] = useState(-1);\nconst [progress, setProgress] = useState(0);\nconst [preProfile, setPreProfile] = useState(\" \");\nconst [viewedPosts, setViewedPosts] = useState([]);\nconst { user: currentUser } = useContext(AuthContext);\nconst isMobileDevice = useMediaQuery({ query: \"(min-device-width: 480px)\", });\nconst isTabletDevice = useMediaQuery({ query: \"(min-device-width: 768px)\", });\nconst [socket, setSocket] = useState(null)\nconst [open, setOpen] = React.useState(false);\n \nlet postCallCount = 0; \nlet maxCalls = 5; \n\n  const handleClickOpen = () => {\n    setOpen(true);\n  };\n\n  const handleClose = () => {\n    setOpen(false);\n    continueProcess(0)\n    setPosts(prevPosts => prevPosts.slice(1));\n  };\n  \n  const handleYes = async (e) => {\n    setOpen(false);\n    \n    const firstPost = posts[0];\n    \n    setTimeout(() => {\n        setPosts(prevPosts => prevPosts.slice(1));\n      }, 1000);\n    \n    const token = localStorage.getItem('token');\n        const newPost = {\n          userId: user._id,\n          desc: firstPost.desc,\n          thumb: firstPost.thumb,\n          pool:user.pool,\n          headers: { 'auth-token': token },\n        };\n        try {\n            const pst = await axios.post(\"/posts/\" + user._id + \"/create\", newPost);\n            socket.emit('sendMessage', pst);\n            await axios.post(\"/posts/UserReadSpecialPost\", {\"postId\": firstPost._id, \"userId\":user._id , headers: { 'auth-token': token }})\n            continueProcess(10000)\n            postCallCount++;\n    } catch (err) {console.log(err);\n    }\n  };\n  \n  const continueProcess = (dlay) => {\n    if (postCallCount < maxCalls) {\n      // Call showPostsInOrder again after 60 seconds\n      setTimeout(() => {\n        showPostsInOrder();\n        \n  \n        // Continue the process by checking the condition in handleYes\n        if (postCallCount < maxCalls) {\n          setTimeout(() => {\n            //handleYes();\n          }, 5000);  // Wait 20 seconds after showPostsInOrder for handleYes\n        }\n  \n      }, dlay);  // 60000 milliseconds = 60 seconds\n    } else {\n      console.log(\"Process stopped after 5 calls.\");\n    }\n  };\n  \n\nconst [windowSize, setWindowSize] = useState(getWindowSize());\n\n//useEffect(() => {\n    //console.log(\"setSocket\");\n    //setSocket(io('wss://cleopatra.ijs.si/chat', {\n     //   transports: [ 'polling'],\n    //    withCredentials: true\n    //  }));\n      \n    \n//}, [])\n\nuseEffect(() => {\n    console.log('Posts updated: ', posts);\n}, [posts]);\n\nuseEffect(() => {\n\n    socket?.emit('addUser', user?.id)\n        console.log(\"active users \")\n        socket?.on('getUsers', users => { \n            console.log(\"active users \", users)\n        })\n\n    socket?.on('getMessage', res => {\n        console.log('active data: >>', res.data );\n        if(res.data.pool == user.pool){\n            const arr = [res.data]\n            setPosts((prevItems) => [...arr, ...prevItems]);\n            console.log('posts data: >>', posts );\n        }\n        \n        //fetchPosts(selectedValue); \n    });\n    \n}, [socket]);\n\nconst showPostsInOrder = async () => {\n    const token = localStorage.getItem('token');\n    console.log(\"showPostsInOrder\");\n    const res = await axios.get(\"/posts/\" + currentUser._id + \"/getSpecialPosts\", {headers: { 'auth-token': token }})\n    console.log(res.data);\n    \n    if(res.data['no']){\n        const arr = [{\"_id\": res.data[\"_id\"], \"desc\":res.data[\"desc\"], \"pool\":res.data[\"pool\"] , \"userId\": \"66f590ae38f16e2cea8d0646\", \"thumb\":\"https://fastly.picsum.photos/id/451/200/300.jpg?blur=5&hmac=Cs_EydLmPTWdSMrzBl8vXIG9b3CaH9iP_yVdDFiXUhU\", \"likes\":[],\n        \"dislikes\":[], \"comments\":[], \"reposts\":[], \"rank\":1000}]\n        setPosts((prevItems) => [...arr, ...prevItems]);\n        console.log('posts data: >>', posts );\n\n        //postCallCount++;\n        setTimeout(handleClickOpen, 5000);\n}\n\n  };\n\n\nconst increment  = async (pv, iv) => {\n    console.log(\"increatem\");\n    console.log(pv);\n    console.log(iv);\n    setIndex(pv+iv);\n    console.log(index);\n};\n\n    /*async function registerAndSubscribe () {\n    try {\n        const serviceWorkerReg = await regSw ();\n        await subscribe (serviceWorkerReg);\n    } catch (error) {\n        console.log (error);\n    }\n}*/\n\nconst {user} = useContext(AuthContext);\nconst [followed, setFollowed] = useState([]\n    //currentUser.followings.includes(user?.id)\n    );\n\n    if(preFilter == -1){\n    console.log(preFilter);\n    setPreFilter(selectedValue);\n\n    } else if(preFilter !== selectedValue){\n    setIndex(0);\n    setPosts([]);\n    setPreFilter(selectedValue);\n\n    }\n\nconst chek = username ?  true : false;\nif(chek == true) {\n    console.log(preProfile);\n    console.log(\"User name1\");\n    console.log(username);\n    const ii = (preProfile === username) ? true : false;\n    console.log(ii);\nif (preProfile === \" \") {\n    setPreProfile(username);\n    console.log(\"User name2\");\n    console.log(username);\n    console.log(preProfile);\n    console.log(user.username);\n} else if(preProfile !== username) {\n    console.log(\"a NEW User name\");\n    console.log(username);\n    setIndex(0);\n    setPosts([]);\n    setPreProfile(username);\n}\n}\n\nconst filterLoadedPosts = async () => {\n    console.log(\"filterLoadedPosts\");\n    if (searchTerm === '') {\n        setPosts(posts);\n    } else {\n        const filteredData = posts.filter((post) => {\n        return post.desc.toLowerCase().includes(searchTerm.toLowerCase())\n        });\n        setPosts(filteredData);\n    }\n    \n}\n\nconst fetchPosts = async (selectedValue) => {\n    setProgress(30);\n    console.log(\"fetchpost\")\n    const chek = username ?  true : false;\nif(chek == true) {\n    console.log(preProfile);\n    console.log(\"User name1\");\n    console.log(username);\n    const ii = (preProfile === username) ? true : false;\n    console.log(ii);\nif (preProfile === \" \") {\n    setPreProfile(username);\n    console.log(\"User name2\");\n    console.log(username);\n    console.log(preProfile);\n    console.log(user.username);\n} else if(preProfile !== username) {\n    console.log(\"a NEW User name\");\n    console.log(username);\n    setIndex(0);\n    setPosts([]);\n    setPreProfile(username);\n}\n}\n\n    var whPosts = \"/posts/timelinePag/\";\n\n    if(selectedValue == 0){\n    var whPosts = \"/posts/timelinePag/\";\n    }\n    else if (selectedValue == 1){\n        whPosts = \"/posts/onlyFollowersPag/\"\n    }\n    else if (selectedValue == 2){\n        whPosts = \"/posts/onlyFollowingsPag/\"\n    }\n    console.log(preFilter);\n    console.log(whPosts);\n    const token = localStorage.getItem('token');\n    const res = username ?  await axios.get(\"/posts/profile/\" + username+`?page=${index}`, {headers: { 'auth-token': token, 'userId': user._id }}) : await axios.get(whPosts + user._id+`?page=${index}`, {headers: { 'auth-token': token, 'userId': user._id }});\n    console.log(res.data);\n    console.log(\"fetch posts\");\n    if(res.data.length){\n    if(res.data.length > 0){\n        setPosts((prevItems) => [...prevItems, ...res.data\n            //.sort((p1,p2) => {return new Date(p2.createdAt) - new Date(p1.createdAt);})\n        ]); \n        res.data.length%20 > 0 ? setHasMore(false) : setHasMore(true);\n        //setIndex((index) => index + 1);\n        increment(index, 1);\n        setProgress(100);\n    } else {\n        setHasMore(false);\n        setProgress(100);\n        //setPosts([]);\n        //setIndex((index) => 0);\n        //increment(index, -index);\n    }\n\n    //setPreFilter(whPosts);\n    console.log(whPosts);\n    //setPosts(res.data.sort((p1,p2) => {return new Date(p2.createdAt) - new Date(p1.createdAt);})); \n}};\n\nfunction updateViewdPosts( post) {\n    /*const oldViewed = [...viewedPosts, post];\n    setViewedPosts(oldViewed);\n    console.log(\"array  \", viewedPosts);\n    console.log(\"post id  \", post);\n    console.log(\"viewed length \", viewedPosts.length);\n    if(viewedPosts.length == 10){\n        axios.put(\"/users/\" + currentUser._id + \"/viewed\", { postId: post });\n        setViewedPosts([]);\n    }*/\n    }\n\nconst fetchMoreData = async () => {\n    setProgress(30);\n    if(searchTerm? searchTerm.length !== 0 : false){\n        console.log(\"searchTerm\");\n        console.log(searchTerm.length);\n        setProgress(100);\n        return\n    }\n\n    if(index == 0){\n        setProgress(100);\n        return\n    }\n    //console.log(\"fetchpost\")\n    \n    console.log(\"fetch more  posts\");\n    console.log(selectedValue);\n    var whPosts = \"/posts/timelinePag/\";\n\n    if(selectedValue == 0){\n        whPosts = \"/posts/timelinePag/\"\n    }\n    else if (selectedValue == 1){\n        whPosts = \"/posts/onlyFollowersPag/\"\n    }\n    else if (selectedValue == 2){\n        whPosts = \"/posts/onlyFollowingsPag/\"\n    }\n\n    const token = localStorage.getItem('token');\n    const res = username ?  await axios.get(\"/posts/profile/\" + username+`?page=${index}`, {headers: { 'auth-token': token }}): await axios.get(whPosts + user._id+`?page=${index}`, {headers: { 'auth-token': token }});\n    //console.log(res.data);\n    \n    if(res.data.length > 0){\n        setPosts((prevItems) => [...prevItems, ...res.data\n            //.sort((p1,p2) => {return new Date(p2.createdAt) - new Date(p1.createdAt);})\n        ]); \n         res.data.length%20 > 0 ? setHasMore(false) : setHasMore(true);\n        increment(index, 1);\n        setProgress(100);\n    }else {\n        setHasMore(false);\n        setProgress(100);\n        //setPosts([]);\n        //setIndex((index) => 0);\n        //increment(index, -index);\n    }\n};\n\nfunction getWindowSize() {\n    const {innerWidth, innerHeight} = window;\n    return {innerWidth, innerHeight};\n    };\n\nuseEffect(() => {\n    //registerAndSubscribe();\n\n    console.log(\"use effects!\");\n    //showPostsInOrder();\n    \n    if (selectedValue !=10){\n    ///// Remove this breakpoint during the casestudy\n        //filterLoadedPosts()\n        if(searchTerm? searchTerm.length !== 0 : false){\n            console.log(\"searchTerm\");\n            console.log(searchTerm.length);\n            filterLoadedPosts()\n        } else {\n            //filterLoadedPosts()\n            fetchPosts(selectedValue);\n    }\n    }\n\n    function handleWindowResize() {\n        setWindowSize(getWindowSize());\n        }\n    \n        window.addEventListener('resize', handleWindowResize);\n    \n        return () => {\n        window.removeEventListener('resize', handleWindowResize);\n        };\n\n        \n\n}, [username, user._id, selectedValue, searchTerm])\n\nconst refreshed = async (selectedValue) => {\n    console.log(\"refreshed\");\n    setPosts([]);\n    const chek = username ?  true : false;\nif(chek == true) {\n    console.log(preProfile);\n    console.log(\"User name1\");\n    console.log(username);\n    const ii = (preProfile === username) ? true : false;\n    console.log(ii);\n    \nif (preProfile === \" \") {\n    setPreProfile(username);\n    console.log(\"User name2\");\n    console.log(username);\n    console.log(preProfile);\n    console.log(user.username);\n    \n} else if(preProfile !== username) {\n    console.log(\"a NEW User name\");\n    console.log(username);\n    setIndex(0);\n    setPosts([]);\n    setPreProfile(username);\n}\n}\n\n    var whPosts = \"/posts/timelinePag/\";\n\n    if(selectedValue == 0){\n    var whPosts = \"/posts/timelinePag/\";\n    }\n    else if (selectedValue == 1){\n        whPosts = \"/posts/onlyFollowersPag/\"\n    }\n    else if (selectedValue == 2){\n        whPosts = \"/posts/onlyFollowingsPag/\"\n    }\n    console.log(preFilter);\n    console.log(whPosts);\n    const token = localStorage.getItem('token');\n    const res = username ?  await axios.get(\"/posts/profile/\" + username+`?page=${0}`, {headers: { 'auth-token': token }}) : await axios.get(whPosts + user._id+`?page=${0}`, {headers: { 'auth-token': token }});\n    console.log(res.data);\n    console.log(\"fetch posts\");\n    if(res.data.length){\n    if(res.data.length > 0){\n        setPosts((prevItems) => [...prevItems, ...res.data\n            //.sort((p1,p2) => {return new Date(p2.createdAt) - new Date(p1.createdAt);})\n        ]); \n        res.data.length%20 > 0 ? setHasMore(false) : setHasMore(true);\n        //setIndex((index) => index + 1);\n        increment(0, 1);\n    } else {\n        setHasMore(false)\n        //setPosts([]);\n        //setIndex((index) => 0);\n        //increment(index, -index);\n    }\n\n    //setPreFilter(whPosts);\n    console.log(whPosts);\n}}\n\nreturn (\n    <div className={classes.feed}>\n    <LoadingBar   color=\"#f11946\"   progress={progress}   onLoaderFinished={() => setProgress(0)} />\n        <InfiniteScroll dataLength={posts.length} next={fetchMoreData} hasMore={hasMore} loader={<Loader />}>\n        <div className={classes.feedWrapper} style={{\"width\": (!isMobileDevice && !isTabletDevice) && (windowSize.innerWidth-10)+\"px\"}}>\n            {( !username || username === user.username) }\n            {posts.map((p) => {\n                return <Post onScrolling={updateViewdPosts} key={p._id} post={p} isDetail={false}/>\n            })}\n        </div>\n        </InfiniteScroll>\n        \n        {/*<React.Fragment>\n      <Dialog\n        open={open}\n        TransitionComponent={Transition}\n        keepMounted\n        onClose={handleClose}\n        aria-describedby=\"alert-dialog-slide-description\"\n      >\n        <DialogTitle>{\"Attention\"}</DialogTitle>\n        <DialogContent>\n          <DialogContentText id=\"alert-dialog-slide-description\">\n            Have you read the new post??\n          </DialogContentText>\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={handleYes}>Yes</Button>\n          <Button onClick={handleClose}>No</Button>\n        </DialogActions>\n      </Dialog>\n    </React.Fragment>*/}\n        \n        \n    </div>\n    \n    \n    \n)\n}\n\nexport default withStyles(styles)(Feed);"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CACzB,OAAQC,QAAQ,CAAEC,SAAS,KAAO,OAAO,CACzC,MAAO,CAAAC,IAAI,KAAM,cAAc,CAC/B,MAAO,CAAAC,KAAK,KAAM,gBAAgB,CAClC,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,OAASC,UAAU,KAAQ,OAAO,CAClC,OAASC,WAAW,KAAQ,2BAA2B,CACvD,OAASC,UAAU,KAAQ,0BAA0B,CACrD,OAAQC,MAAM,KAAO,aAAa,CAClC,MAAO,CAAAC,cAAc,KAAM,iCAAiC,CAC5D,MAAO,CAAAC,MAAM,KAAM,kBAAkB,CACrC,MAAO,CAAAC,UAAU,KAAM,uBAAuB,CAC9C,OAASC,aAAa,KAAQ,kBAAkB,CAChD,OAAQC,MAAM,KAAO,OAAO,CAC5B,OAAQC,KAAK,CAAEC,SAAS,KAAO,iBAAiB,CAChD,OAAQC,EAAE,KAAO,kBAAkB,CAEnC,MAAO,CAAAC,MAAM,KAAM,sBAAsB,CACzC,MAAO,CAAAC,MAAM,KAAM,sBAAsB,CACzC,MAAO,CAAAC,aAAa,KAAM,6BAA6B,CACvD,MAAO,CAAAC,aAAa,KAAM,6BAA6B,CACvD,MAAO,CAAAC,iBAAiB,KAAM,iCAAiC,CAC/D,MAAO,CAAAC,WAAW,KAAM,2BAA2B,CACnD,MAAO,CAAAC,KAAK,KAAM,qBAAqB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAExC,KAAM,CAAAC,UAAU,cAAG7B,KAAK,CAAC8B,UAAU,CAAC,QAAS,CAAAD,UAAUA,CAACE,KAAK,CAAEC,GAAG,CAAE,CAClE,mBAAON,IAAA,CAACF,KAAK,EAACS,SAAS,CAAC,IAAI,CAACD,GAAG,CAAEA,GAAI,IAAKD,KAAK,CAAG,CAAC,CACtD,CAAC,CAAC,CAGF,QAAS,CAAAG,IAAIA,CAAAC,IAAA,CAAiD,IAAhD,CAACC,QAAQ,CAAEC,OAAO,CAAEC,aAAa,CAAEC,UAAU,CAAC,CAAAJ,IAAA,CAC5D,KAAM,CAACK,KAAK,CAAEC,QAAQ,CAAC,CAAGxC,QAAQ,CAAC,EAAE,CAAC,CACtC,KAAM,CAACyC,OAAO,CAAEC,UAAU,CAAC,CAAG1C,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAAC2C,KAAK,CAAEC,QAAQ,CAAC,CAAG5C,QAAQ,CAAC,CAAC,CAAC,CACrC,KAAM,CAAC6C,UAAU,CAAEC,aAAa,CAAC,CAAG9C,QAAQ,CAAC,KAAK,CAAC,CACnD,KAAM,CAAC+C,SAAS,CAAEC,YAAY,CAAC,CAAGhD,QAAQ,CAAC,CAAC,CAAC,CAAC,CAC9C,KAAM,CAACiD,QAAQ,CAAEC,WAAW,CAAC,CAAGlD,QAAQ,CAAC,CAAC,CAAC,CAC3C,KAAM,CAACmD,UAAU,CAAEC,aAAa,CAAC,CAAGpD,QAAQ,CAAC,GAAG,CAAC,CACjD,KAAM,CAACqD,WAAW,CAAEC,cAAc,CAAC,CAAGtD,QAAQ,CAAC,EAAE,CAAC,CAClD,KAAM,CAAEuD,IAAI,CAAEC,WAAY,CAAC,CAAGnD,UAAU,CAACC,WAAW,CAAC,CACrD,KAAM,CAAAmD,cAAc,CAAG7C,aAAa,CAAC,CAAE8C,KAAK,CAAE,2BAA6B,CAAC,CAAC,CAC7E,KAAM,CAAAC,cAAc,CAAG/C,aAAa,CAAC,CAAE8C,KAAK,CAAE,2BAA6B,CAAC,CAAC,CAC7E,KAAM,CAACE,MAAM,CAAEC,SAAS,CAAC,CAAG7D,QAAQ,CAAC,IAAI,CAAC,CAC1C,KAAM,CAAC8D,IAAI,CAAEC,OAAO,CAAC,CAAGhE,KAAK,CAACC,QAAQ,CAAC,KAAK,CAAC,CAE7C,GAAI,CAAAgE,aAAa,CAAG,CAAC,CACrB,GAAI,CAAAC,QAAQ,CAAG,CAAC,CAEd,KAAM,CAAAC,eAAe,CAAGA,CAAA,GAAM,CAC5BH,OAAO,CAAC,IAAI,CAAC,CACf,CAAC,CAED,KAAM,CAAAI,WAAW,CAAGA,CAAA,GAAM,CACxBJ,OAAO,CAAC,KAAK,CAAC,CACdK,eAAe,CAAC,CAAC,CAAC,CAClB5B,QAAQ,CAAC6B,SAAS,EAAIA,SAAS,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CAC3C,CAAC,CAED,KAAM,CAAAC,SAAS,CAAG,KAAO,CAAAC,CAAC,EAAK,CAC7BT,OAAO,CAAC,KAAK,CAAC,CAEd,KAAM,CAAAU,SAAS,CAAGlC,KAAK,CAAC,CAAC,CAAC,CAE1BmC,UAAU,CAAC,IAAM,CACblC,QAAQ,CAAC6B,SAAS,EAAIA,SAAS,CAACC,KAAK,CAAC,CAAC,CAAC,CAAC,CAC3C,CAAC,CAAE,IAAI,CAAC,CAEV,KAAM,CAAAK,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CACvC,KAAM,CAAAC,OAAO,CAAG,CACdC,MAAM,CAAExB,IAAI,CAACyB,GAAG,CAChBC,IAAI,CAAER,SAAS,CAACQ,IAAI,CACpBC,KAAK,CAAET,SAAS,CAACS,KAAK,CACtBC,IAAI,CAAC5B,IAAI,CAAC4B,IAAI,CACdC,OAAO,CAAE,CAAE,YAAY,CAAET,KAAM,CACjC,CAAC,CACD,GAAI,CACA,KAAM,CAAAU,GAAG,CAAG,KAAM,CAAAjF,KAAK,CAACkF,IAAI,CAAC,SAAS,CAAG/B,IAAI,CAACyB,GAAG,CAAG,SAAS,CAAEF,OAAO,CAAC,CACvElB,MAAM,CAAC2B,IAAI,CAAC,aAAa,CAAEF,GAAG,CAAC,CAC/B,KAAM,CAAAjF,KAAK,CAACkF,IAAI,CAAC,4BAA4B,CAAE,CAAC,QAAQ,CAAEb,SAAS,CAACO,GAAG,CAAE,QAAQ,CAACzB,IAAI,CAACyB,GAAG,CAAGI,OAAO,CAAE,CAAE,YAAY,CAAET,KAAM,CAAC,CAAC,CAAC,CAC/HP,eAAe,CAAC,KAAK,CAAC,CACtBJ,aAAa,EAAE,CACvB,CAAE,MAAOwB,GAAG,CAAE,CAACC,OAAO,CAACC,GAAG,CAACF,GAAG,CAAC,CAC/B,CACF,CAAC,CAED,KAAM,CAAApB,eAAe,CAAIuB,IAAI,EAAK,CAChC,GAAI3B,aAAa,CAAGC,QAAQ,CAAE,CAC5B;AACAS,UAAU,CAAC,IAAM,CACfkB,gBAAgB,CAAC,CAAC,CAGlB;AACA,GAAI5B,aAAa,CAAGC,QAAQ,CAAE,CAC5BS,UAAU,CAAC,IAAM,CACf;AAAA,CACD,CAAE,IAAI,CAAC,CAAG;AACb,CAEF,CAAC,CAAEiB,IAAI,CAAC,CAAG;AACb,CAAC,IAAM,CACLF,OAAO,CAACC,GAAG,CAAC,gCAAgC,CAAC,CAC/C,CACF,CAAC,CAGH,KAAM,CAACG,UAAU,CAAEC,aAAa,CAAC,CAAG9F,QAAQ,CAAC+F,aAAa,CAAC,CAAC,CAAC,CAE7D;AACI;AACA;AACC;AACD;AACA;AAGJ;AAEA9F,SAAS,CAAC,IAAM,CACZwF,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAEnD,KAAK,CAAC,CACzC,CAAC,CAAE,CAACA,KAAK,CAAC,CAAC,CAEXtC,SAAS,CAAC,IAAM,CAEZ2D,MAAM,SAANA,MAAM,iBAANA,MAAM,CAAE2B,IAAI,CAAC,SAAS,CAAEhC,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAEyC,EAAE,CAAC,CAC7BP,OAAO,CAACC,GAAG,CAAC,eAAe,CAAC,CAC5B9B,MAAM,SAANA,MAAM,iBAANA,MAAM,CAAEqC,EAAE,CAAC,UAAU,CAAEC,KAAK,EAAI,CAC5BT,OAAO,CAACC,GAAG,CAAC,eAAe,CAAEQ,KAAK,CAAC,CACvC,CAAC,CAAC,CAENtC,MAAM,SAANA,MAAM,iBAANA,MAAM,CAAEqC,EAAE,CAAC,YAAY,CAAEE,GAAG,EAAI,CAC5BV,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAES,GAAG,CAACC,IAAK,CAAC,CACzC,GAAGD,GAAG,CAACC,IAAI,CAACjB,IAAI,EAAI5B,IAAI,CAAC4B,IAAI,CAAC,CAC1B,KAAM,CAAAkB,GAAG,CAAG,CAACF,GAAG,CAACC,IAAI,CAAC,CACtB5D,QAAQ,CAAE8D,SAAS,EAAK,CAAC,GAAGD,GAAG,CAAE,GAAGC,SAAS,CAAC,CAAC,CAC/Cb,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAEnD,KAAM,CAAC,CACzC,CAEA;AACJ,CAAC,CAAC,CAEN,CAAC,CAAE,CAACqB,MAAM,CAAC,CAAC,CAEZ,KAAM,CAAAgC,gBAAgB,CAAG,KAAAA,CAAA,GAAY,CACjC,KAAM,CAAAjB,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3CY,OAAO,CAACC,GAAG,CAAC,kBAAkB,CAAC,CAC/B,KAAM,CAAAS,GAAG,CAAG,KAAM,CAAA/F,KAAK,CAACmG,GAAG,CAAC,SAAS,CAAG/C,WAAW,CAACwB,GAAG,CAAG,kBAAkB,CAAE,CAACI,OAAO,CAAE,CAAE,YAAY,CAAET,KAAM,CAAC,CAAC,CAAC,CACjHc,OAAO,CAACC,GAAG,CAACS,GAAG,CAACC,IAAI,CAAC,CAErB,GAAGD,GAAG,CAACC,IAAI,CAAC,IAAI,CAAC,CAAC,CACd,KAAM,CAAAC,GAAG,CAAG,CAAC,CAAC,KAAK,CAAEF,GAAG,CAACC,IAAI,CAAC,KAAK,CAAC,CAAE,MAAM,CAACD,GAAG,CAACC,IAAI,CAAC,MAAM,CAAC,CAAE,MAAM,CAACD,GAAG,CAACC,IAAI,CAAC,MAAM,CAAC,CAAG,QAAQ,CAAE,0BAA0B,CAAE,OAAO,CAAC,yGAAyG,CAAE,OAAO,CAAC,EAAE,CAC5P,UAAU,CAAC,EAAE,CAAE,UAAU,CAAC,EAAE,CAAE,SAAS,CAAC,EAAE,CAAE,MAAM,CAAC,IAAI,CAAC,CAAC,CACzD5D,QAAQ,CAAE8D,SAAS,EAAK,CAAC,GAAGD,GAAG,CAAE,GAAGC,SAAS,CAAC,CAAC,CAC/Cb,OAAO,CAACC,GAAG,CAAC,gBAAgB,CAAEnD,KAAM,CAAC,CAErC;AACAmC,UAAU,CAACR,eAAe,CAAE,IAAI,CAAC,CACzC,CAEE,CAAC,CAGH,KAAM,CAAAsC,SAAS,CAAI,KAAAA,CAAOC,EAAE,CAAEC,EAAE,GAAK,CACjCjB,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC,CACxBD,OAAO,CAACC,GAAG,CAACe,EAAE,CAAC,CACfhB,OAAO,CAACC,GAAG,CAACgB,EAAE,CAAC,CACf9D,QAAQ,CAAC6D,EAAE,CAACC,EAAE,CAAC,CACfjB,OAAO,CAACC,GAAG,CAAC/C,KAAK,CAAC,CACtB,CAAC,CAEG;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,GAEA,KAAM,CAACY,IAAI,CAAC,CAAGlD,UAAU,CAACC,WAAW,CAAC,CACtC,KAAM,CAACqG,QAAQ,CAAEC,WAAW,CAAC,CAAG5G,QAAQ,CAAC,EACrC;AACA,CAAC,CAED,GAAG+C,SAAS,EAAI,CAAC,CAAC,CAAC,CACnB0C,OAAO,CAACC,GAAG,CAAC3C,SAAS,CAAC,CACtBC,YAAY,CAACX,aAAa,CAAC,CAE3B,CAAC,IAAM,IAAGU,SAAS,GAAKV,aAAa,CAAC,CACtCO,QAAQ,CAAC,CAAC,CAAC,CACXJ,QAAQ,CAAC,EAAE,CAAC,CACZQ,YAAY,CAACX,aAAa,CAAC,CAE3B,CAEJ,KAAM,CAAAwE,IAAI,CAAG1E,QAAQ,CAAI,IAAI,CAAG,KAAK,CACrC,GAAG0E,IAAI,EAAI,IAAI,CAAE,CACbpB,OAAO,CAACC,GAAG,CAACvC,UAAU,CAAC,CACvBsC,OAAO,CAACC,GAAG,CAAC,YAAY,CAAC,CACzBD,OAAO,CAACC,GAAG,CAACvD,QAAQ,CAAC,CACrB,KAAM,CAAA2E,EAAE,CAAI3D,UAAU,GAAKhB,QAAQ,CAAI,IAAI,CAAG,KAAK,CACnDsD,OAAO,CAACC,GAAG,CAACoB,EAAE,CAAC,CACnB,GAAI3D,UAAU,GAAK,GAAG,CAAE,CACpBC,aAAa,CAACjB,QAAQ,CAAC,CACvBsD,OAAO,CAACC,GAAG,CAAC,YAAY,CAAC,CACzBD,OAAO,CAACC,GAAG,CAACvD,QAAQ,CAAC,CACrBsD,OAAO,CAACC,GAAG,CAACvC,UAAU,CAAC,CACvBsC,OAAO,CAACC,GAAG,CAACnC,IAAI,CAACpB,QAAQ,CAAC,CAC9B,CAAC,IAAM,IAAGgB,UAAU,GAAKhB,QAAQ,CAAE,CAC/BsD,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAC,CAC9BD,OAAO,CAACC,GAAG,CAACvD,QAAQ,CAAC,CACrBS,QAAQ,CAAC,CAAC,CAAC,CACXJ,QAAQ,CAAC,EAAE,CAAC,CACZY,aAAa,CAACjB,QAAQ,CAAC,CAC3B,CACA,CAEA,KAAM,CAAA4E,iBAAiB,CAAG,KAAAA,CAAA,GAAY,CAClCtB,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAC,CAChC,GAAIpD,UAAU,GAAK,EAAE,CAAE,CACnBE,QAAQ,CAACD,KAAK,CAAC,CACnB,CAAC,IAAM,CACH,KAAM,CAAAyE,YAAY,CAAGzE,KAAK,CAAC0E,MAAM,CAAE3B,IAAI,EAAK,CAC5C,MAAO,CAAAA,IAAI,CAACL,IAAI,CAACiC,WAAW,CAAC,CAAC,CAACC,QAAQ,CAAC7E,UAAU,CAAC4E,WAAW,CAAC,CAAC,CAAC,CACjE,CAAC,CAAC,CACF1E,QAAQ,CAACwE,YAAY,CAAC,CAC1B,CAEJ,CAAC,CAED,KAAM,CAAAI,UAAU,CAAG,KAAO,CAAA/E,aAAa,EAAK,CACxCa,WAAW,CAAC,EAAE,CAAC,CACfuC,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC,CACxB,KAAM,CAAAmB,IAAI,CAAG1E,QAAQ,CAAI,IAAI,CAAG,KAAK,CACzC,GAAG0E,IAAI,EAAI,IAAI,CAAE,CACbpB,OAAO,CAACC,GAAG,CAACvC,UAAU,CAAC,CACvBsC,OAAO,CAACC,GAAG,CAAC,YAAY,CAAC,CACzBD,OAAO,CAACC,GAAG,CAACvD,QAAQ,CAAC,CACrB,KAAM,CAAA2E,EAAE,CAAI3D,UAAU,GAAKhB,QAAQ,CAAI,IAAI,CAAG,KAAK,CACnDsD,OAAO,CAACC,GAAG,CAACoB,EAAE,CAAC,CACnB,GAAI3D,UAAU,GAAK,GAAG,CAAE,CACpBC,aAAa,CAACjB,QAAQ,CAAC,CACvBsD,OAAO,CAACC,GAAG,CAAC,YAAY,CAAC,CACzBD,OAAO,CAACC,GAAG,CAACvD,QAAQ,CAAC,CACrBsD,OAAO,CAACC,GAAG,CAACvC,UAAU,CAAC,CACvBsC,OAAO,CAACC,GAAG,CAACnC,IAAI,CAACpB,QAAQ,CAAC,CAC9B,CAAC,IAAM,IAAGgB,UAAU,GAAKhB,QAAQ,CAAE,CAC/BsD,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAC,CAC9BD,OAAO,CAACC,GAAG,CAACvD,QAAQ,CAAC,CACrBS,QAAQ,CAAC,CAAC,CAAC,CACXJ,QAAQ,CAAC,EAAE,CAAC,CACZY,aAAa,CAACjB,QAAQ,CAAC,CAC3B,CACA,CAEI,GAAI,CAAAkF,OAAO,CAAG,qBAAqB,CAEnC,GAAGhF,aAAa,EAAI,CAAC,CAAC,CACtB,GAAI,CAAAgF,OAAO,CAAG,qBAAqB,CACnC,CAAC,IACI,IAAIhF,aAAa,EAAI,CAAC,CAAC,CACxBgF,OAAO,CAAG,0BAA0B,CACxC,CAAC,IACI,IAAIhF,aAAa,EAAI,CAAC,CAAC,CACxBgF,OAAO,CAAG,2BAA2B,CACzC,CACA5B,OAAO,CAACC,GAAG,CAAC3C,SAAS,CAAC,CACtB0C,OAAO,CAACC,GAAG,CAAC2B,OAAO,CAAC,CACpB,KAAM,CAAA1C,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,KAAM,CAAAsB,GAAG,CAAGhE,QAAQ,CAAI,KAAM,CAAA/B,KAAK,CAACmG,GAAG,CAAC,iBAAiB,CAAGpE,QAAQ,UAAAmF,MAAA,CAAU3E,KAAK,CAAE,CAAE,CAACyC,OAAO,CAAE,CAAE,YAAY,CAAET,KAAK,CAAE,QAAQ,CAAEpB,IAAI,CAACyB,GAAI,CAAC,CAAC,CAAC,CAAG,KAAM,CAAA5E,KAAK,CAACmG,GAAG,CAACc,OAAO,CAAG9D,IAAI,CAACyB,GAAG,UAAAsC,MAAA,CAAU3E,KAAK,CAAE,CAAE,CAACyC,OAAO,CAAE,CAAE,YAAY,CAAET,KAAK,CAAE,QAAQ,CAAEpB,IAAI,CAACyB,GAAI,CAAC,CAAC,CAAC,CAC7PS,OAAO,CAACC,GAAG,CAACS,GAAG,CAACC,IAAI,CAAC,CACrBX,OAAO,CAACC,GAAG,CAAC,aAAa,CAAC,CAC1B,GAAGS,GAAG,CAACC,IAAI,CAACmB,MAAM,CAAC,CACnB,GAAGpB,GAAG,CAACC,IAAI,CAACmB,MAAM,CAAG,CAAC,CAAC,CACnB/E,QAAQ,CAAE8D,SAAS,EAAK,CAAC,GAAGA,SAAS,CAAE,GAAGH,GAAG,CAACC,IAC1C;AAAA,CACH,CAAC,CACFD,GAAG,CAACC,IAAI,CAACmB,MAAM,CAAC,EAAE,CAAG,CAAC,CAAG7E,UAAU,CAAC,KAAK,CAAC,CAAGA,UAAU,CAAC,IAAI,CAAC,CAC7D;AACA8D,SAAS,CAAC7D,KAAK,CAAE,CAAC,CAAC,CACnBO,WAAW,CAAC,GAAG,CAAC,CACpB,CAAC,IAAM,CACHR,UAAU,CAAC,KAAK,CAAC,CACjBQ,WAAW,CAAC,GAAG,CAAC,CAChB;AACA;AACA;AACJ,CAEA;AACAuC,OAAO,CAACC,GAAG,CAAC2B,OAAO,CAAC,CACpB;AACJ,CAAC,CAAC,CAEF,QAAS,CAAAG,gBAAgBA,CAAElC,IAAI,CAAE,CAC7B;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OARI,CAWJ,KAAM,CAAAmC,aAAa,CAAG,KAAAA,CAAA,GAAY,CAC9BvE,WAAW,CAAC,EAAE,CAAC,CACf,GAAGZ,UAAU,CAAEA,UAAU,CAACiF,MAAM,GAAK,CAAC,CAAG,KAAK,CAAC,CAC3C9B,OAAO,CAACC,GAAG,CAAC,YAAY,CAAC,CACzBD,OAAO,CAACC,GAAG,CAACpD,UAAU,CAACiF,MAAM,CAAC,CAC9BrE,WAAW,CAAC,GAAG,CAAC,CAChB,OACJ,CAEA,GAAGP,KAAK,EAAI,CAAC,CAAC,CACVO,WAAW,CAAC,GAAG,CAAC,CAChB,OACJ,CACA;AAEAuC,OAAO,CAACC,GAAG,CAAC,mBAAmB,CAAC,CAChCD,OAAO,CAACC,GAAG,CAACrD,aAAa,CAAC,CAC1B,GAAI,CAAAgF,OAAO,CAAG,qBAAqB,CAEnC,GAAGhF,aAAa,EAAI,CAAC,CAAC,CAClBgF,OAAO,CAAG,qBAAqB,CACnC,CAAC,IACI,IAAIhF,aAAa,EAAI,CAAC,CAAC,CACxBgF,OAAO,CAAG,0BAA0B,CACxC,CAAC,IACI,IAAIhF,aAAa,EAAI,CAAC,CAAC,CACxBgF,OAAO,CAAG,2BAA2B,CACzC,CAEA,KAAM,CAAA1C,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,KAAM,CAAAsB,GAAG,CAAGhE,QAAQ,CAAI,KAAM,CAAA/B,KAAK,CAACmG,GAAG,CAAC,iBAAiB,CAAGpE,QAAQ,UAAAmF,MAAA,CAAU3E,KAAK,CAAE,CAAE,CAACyC,OAAO,CAAE,CAAE,YAAY,CAAET,KAAM,CAAC,CAAC,CAAC,CAAE,KAAM,CAAAvE,KAAK,CAACmG,GAAG,CAACc,OAAO,CAAG9D,IAAI,CAACyB,GAAG,UAAAsC,MAAA,CAAU3E,KAAK,CAAE,CAAE,CAACyC,OAAO,CAAE,CAAE,YAAY,CAAET,KAAM,CAAC,CAAC,CAAC,CACpN;AAEA,GAAGwB,GAAG,CAACC,IAAI,CAACmB,MAAM,CAAG,CAAC,CAAC,CACnB/E,QAAQ,CAAE8D,SAAS,EAAK,CAAC,GAAGA,SAAS,CAAE,GAAGH,GAAG,CAACC,IAC1C;AAAA,CACH,CAAC,CACDD,GAAG,CAACC,IAAI,CAACmB,MAAM,CAAC,EAAE,CAAG,CAAC,CAAG7E,UAAU,CAAC,KAAK,CAAC,CAAGA,UAAU,CAAC,IAAI,CAAC,CAC9D8D,SAAS,CAAC7D,KAAK,CAAE,CAAC,CAAC,CACnBO,WAAW,CAAC,GAAG,CAAC,CACpB,CAAC,IAAK,CACFR,UAAU,CAAC,KAAK,CAAC,CACjBQ,WAAW,CAAC,GAAG,CAAC,CAChB;AACA;AACA;AACJ,CACJ,CAAC,CAED,QAAS,CAAA6C,aAAaA,CAAA,CAAG,CACrB,KAAM,CAAC2B,UAAU,CAAEC,WAAW,CAAC,CAAGC,MAAM,CACxC,MAAO,CAACF,UAAU,CAAEC,WAAW,CAAC,CAChC,CAAC,CAEL1H,SAAS,CAAC,IAAM,CACZ;AAEAwF,OAAO,CAACC,GAAG,CAAC,cAAc,CAAC,CAC3B;AAEA,GAAIrD,aAAa,EAAG,EAAE,CAAC,CACvB;AACI;AACA,GAAGC,UAAU,CAAEA,UAAU,CAACiF,MAAM,GAAK,CAAC,CAAG,KAAK,CAAC,CAC3C9B,OAAO,CAACC,GAAG,CAAC,YAAY,CAAC,CACzBD,OAAO,CAACC,GAAG,CAACpD,UAAU,CAACiF,MAAM,CAAC,CAC9BR,iBAAiB,CAAC,CAAC,CACvB,CAAC,IAAM,CACH;AACAK,UAAU,CAAC/E,aAAa,CAAC,CACjC,CACA,CAEA,QAAS,CAAAwF,kBAAkBA,CAAA,CAAG,CAC1B/B,aAAa,CAACC,aAAa,CAAC,CAAC,CAAC,CAC9B,CAEA6B,MAAM,CAACE,gBAAgB,CAAC,QAAQ,CAAED,kBAAkB,CAAC,CAErD,MAAO,IAAM,CACbD,MAAM,CAACG,mBAAmB,CAAC,QAAQ,CAAEF,kBAAkB,CAAC,CACxD,CAAC,CAIT,CAAC,CAAE,CAAC1F,QAAQ,CAAEoB,IAAI,CAACyB,GAAG,CAAE3C,aAAa,CAAEC,UAAU,CAAC,CAAC,CAEnD,KAAM,CAAA0F,SAAS,CAAG,KAAO,CAAA3F,aAAa,EAAK,CACvCoD,OAAO,CAACC,GAAG,CAAC,WAAW,CAAC,CACxBlD,QAAQ,CAAC,EAAE,CAAC,CACZ,KAAM,CAAAqE,IAAI,CAAG1E,QAAQ,CAAI,IAAI,CAAG,KAAK,CACzC,GAAG0E,IAAI,EAAI,IAAI,CAAE,CACbpB,OAAO,CAACC,GAAG,CAACvC,UAAU,CAAC,CACvBsC,OAAO,CAACC,GAAG,CAAC,YAAY,CAAC,CACzBD,OAAO,CAACC,GAAG,CAACvD,QAAQ,CAAC,CACrB,KAAM,CAAA2E,EAAE,CAAI3D,UAAU,GAAKhB,QAAQ,CAAI,IAAI,CAAG,KAAK,CACnDsD,OAAO,CAACC,GAAG,CAACoB,EAAE,CAAC,CAEnB,GAAI3D,UAAU,GAAK,GAAG,CAAE,CACpBC,aAAa,CAACjB,QAAQ,CAAC,CACvBsD,OAAO,CAACC,GAAG,CAAC,YAAY,CAAC,CACzBD,OAAO,CAACC,GAAG,CAACvD,QAAQ,CAAC,CACrBsD,OAAO,CAACC,GAAG,CAACvC,UAAU,CAAC,CACvBsC,OAAO,CAACC,GAAG,CAACnC,IAAI,CAACpB,QAAQ,CAAC,CAE9B,CAAC,IAAM,IAAGgB,UAAU,GAAKhB,QAAQ,CAAE,CAC/BsD,OAAO,CAACC,GAAG,CAAC,iBAAiB,CAAC,CAC9BD,OAAO,CAACC,GAAG,CAACvD,QAAQ,CAAC,CACrBS,QAAQ,CAAC,CAAC,CAAC,CACXJ,QAAQ,CAAC,EAAE,CAAC,CACZY,aAAa,CAACjB,QAAQ,CAAC,CAC3B,CACA,CAEI,GAAI,CAAAkF,OAAO,CAAG,qBAAqB,CAEnC,GAAGhF,aAAa,EAAI,CAAC,CAAC,CACtB,GAAI,CAAAgF,OAAO,CAAG,qBAAqB,CACnC,CAAC,IACI,IAAIhF,aAAa,EAAI,CAAC,CAAC,CACxBgF,OAAO,CAAG,0BAA0B,CACxC,CAAC,IACI,IAAIhF,aAAa,EAAI,CAAC,CAAC,CACxBgF,OAAO,CAAG,2BAA2B,CACzC,CACA5B,OAAO,CAACC,GAAG,CAAC3C,SAAS,CAAC,CACtB0C,OAAO,CAACC,GAAG,CAAC2B,OAAO,CAAC,CACpB,KAAM,CAAA1C,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,KAAM,CAAAsB,GAAG,CAAGhE,QAAQ,CAAI,KAAM,CAAA/B,KAAK,CAACmG,GAAG,CAAC,iBAAiB,CAAGpE,QAAQ,UAAAmF,MAAA,CAAU,CAAC,CAAE,CAAE,CAAClC,OAAO,CAAE,CAAE,YAAY,CAAET,KAAM,CAAC,CAAC,CAAC,CAAG,KAAM,CAAAvE,KAAK,CAACmG,GAAG,CAACc,OAAO,CAAG9D,IAAI,CAACyB,GAAG,UAAAsC,MAAA,CAAU,CAAC,CAAE,CAAE,CAAClC,OAAO,CAAE,CAAE,YAAY,CAAET,KAAM,CAAC,CAAC,CAAC,CAC7Mc,OAAO,CAACC,GAAG,CAACS,GAAG,CAACC,IAAI,CAAC,CACrBX,OAAO,CAACC,GAAG,CAAC,aAAa,CAAC,CAC1B,GAAGS,GAAG,CAACC,IAAI,CAACmB,MAAM,CAAC,CACnB,GAAGpB,GAAG,CAACC,IAAI,CAACmB,MAAM,CAAG,CAAC,CAAC,CACnB/E,QAAQ,CAAE8D,SAAS,EAAK,CAAC,GAAGA,SAAS,CAAE,GAAGH,GAAG,CAACC,IAC1C;AAAA,CACH,CAAC,CACFD,GAAG,CAACC,IAAI,CAACmB,MAAM,CAAC,EAAE,CAAG,CAAC,CAAG7E,UAAU,CAAC,KAAK,CAAC,CAAGA,UAAU,CAAC,IAAI,CAAC,CAC7D;AACA8D,SAAS,CAAC,CAAC,CAAE,CAAC,CAAC,CACnB,CAAC,IAAM,CACH9D,UAAU,CAAC,KAAK,CAAC,CACjB;AACA;AACA;AACJ,CAEA;AACA+C,OAAO,CAACC,GAAG,CAAC2B,OAAO,CAAC,CACxB,CAAC,CAAC,CAEF,mBACI1F,KAAA,QAAKsG,SAAS,CAAE7F,OAAO,CAAC8F,IAAK,CAAAC,QAAA,eAC7B1G,IAAA,CAACd,UAAU,EAAGyH,KAAK,CAAC,SAAS,CAAGnF,QAAQ,CAAEA,QAAS,CAAGoF,gBAAgB,CAAEA,CAAA,GAAMnF,WAAW,CAAC,CAAC,CAAE,CAAE,CAAC,cAC5FzB,IAAA,CAAChB,cAAc,EAAC6H,UAAU,CAAE/F,KAAK,CAACgF,MAAO,CAACgB,IAAI,CAAEd,aAAc,CAAChF,OAAO,CAAEA,OAAQ,CAAC+F,MAAM,cAAE/G,IAAA,CAACf,MAAM,GAAE,CAAE,CAAAyH,QAAA,cACpGxG,KAAA,QAAKsG,SAAS,CAAE7F,OAAO,CAACqG,WAAY,CAACC,KAAK,CAAE,CAAC,OAAO,CAAG,CAACjF,cAAc,EAAI,CAACE,cAAc,EAAMkC,UAAU,CAAC6B,UAAU,CAAC,EAAE,CAAE,IAAI,CAAE,CAAAS,QAAA,EACxH,CAAChG,QAAQ,EAAIA,QAAQ,GAAKoB,IAAI,CAACpB,QAAQ,CACzCI,KAAK,CAACoG,GAAG,CAAEC,CAAC,EAAK,CACd,mBAAOnH,IAAA,CAACvB,IAAI,EAAC2I,WAAW,CAAErB,gBAAiB,CAAalC,IAAI,CAAEsD,CAAE,CAACE,QAAQ,CAAE,KAAM,EAAhCF,CAAC,CAAC5D,GAA+B,CAAC,CACvF,CAAC,CAAC,EACD,CAAC,CACU,CAAC,EAwBhB,CAAC,CAKV,CAEA,cAAe,CAAAzE,UAAU,CAACC,MAAM,CAAC,CAACyB,IAAI,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
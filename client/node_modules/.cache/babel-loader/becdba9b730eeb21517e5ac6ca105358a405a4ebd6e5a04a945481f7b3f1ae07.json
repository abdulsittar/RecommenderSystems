{"ast":null,"code":"import React from'react';import{useContext,useEffect,useState}from\"react\";import{AuthContext}from\"../../context/AuthContext\";import Topbar from\"../../components/topbar/Topbar\";import Post from\"../../components/post/Post\";import{useParams}from'react-router';import{styles}from'./PostdetailStyle';import{colors}from'@material-ui/core';import{withStyles}from'@material-ui/core/styles';import ArrowBackIcon from'@mui/icons-material/ArrowBack';import{useMediaQuery}from'react-responsive';import axios from\"axios\";import{useLocation}from'react-router-dom';import{Link}from'react-router-dom';import LoadingBar from\"react-top-loading-bar\";import{useHistory}from\"react-router\";import{COLORS}from'../../components/values/colors.js';//import User from '../../../../server/models/User';\nimport TimeMe from\"timeme.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Postdetail(_ref){let{classes}=_ref;const history=useHistory();const{state}=useLocation();console.log(state);const[postObj,setPostObj]=useState((state===null||state===void 0?void 0:state.myObj)||{});const[selectedValue,setSelectedValue]=useState('0');const isMobileDevice=useMediaQuery({query:\"(min-device-width: 480px)\"});const isTabletDevice=useMediaQuery({query:\"(min-device-width: 768px)\"});const[shouldSendEvent,setShouldSendEvent]=useState(false);const{user:currentUser,dispatch}=useContext(AuthContext);const username=useParams().username;const PF=process.env.REACT_APP_PUBLIC_FOLDER;const[progress,setProgress]=useState(0);const token=localStorage.getItem('token');const handleReadChange=()=>{axios.put(\"/users/\"+currentUser._id+\"/read\",{postId:state.myObj._id,headers:{'auth-token':token}});};const updateStatus_State=async()=>{try{// Fetch the post by its ID\nsetProgress(30);const res=await axios.get(\"/posts/\".concat(postObj._id),{headers:{\"auth-token\":token}});console.log(\"Fetched post data:\",res.data);setPostObj(res.data);// Update state with the fetched post\nsetProgress(100);}catch(error){console.error(\"Error fetching post:\",error);setProgress(100);}};const handleActivityRecorder=()=>{axios.put(\"/users/\"+currentUser._id+\"/activity\",{page:\"DetailPage\",seconds:TimeMe.getTimeOnCurrentPageInSeconds(),headers:{'auth-token':token}});};useEffect(()=>{updateStatus_State();},[username]);useEffect(()=>{TimeMe.initialize({currentPageName:\"DetailPage\",// current page\nidleTimeoutInSeconds:10// seconds\n});TimeMe.callWhenUserLeaves(()=>{setShouldSendEvent(true);//handleActivityRecorder();\n//handleReadChange();\n});TimeMe.callWhenUserReturns(()=>{setShouldSendEvent(false);});},[]);/*useEffect(() => {\n      TimeMe.initialize({\n        currentPageName: \"PostDetailPage\", // current page\n        idleTimeoutInSeconds: 15 // seconds\n        });\n    \n        TimeMe.callWhenUserLeaves(() => {\n        setShouldSendEvent(true);\n        });\n      \n        TimeMe.callWhenUserReturns(() => {\n        setShouldSendEvent(false);\n        });\n    \n      }, []);*/return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Topbar,{isProfile:\"true\",setSelectedValue:setSelectedValue,style:{'margin-top':'-20px'},showRefreshIcon:true}),/*#__PURE__*/_jsx(\"div\",{className:classes.feed,children:/*#__PURE__*/_jsxs(\"div\",{className:classes.feedWrapper,children:[/*#__PURE__*/_jsx(Link,{style:{textDecoration:'none',color:COLORS.textColor},children:/*#__PURE__*/_jsx(ArrowBackIcon,{onClick:()=>history.goBack()})}),/*#__PURE__*/_jsx(Post,{post:postObj,isDetail:true},postObj._id)]})})]});}export default withStyles(styles)(Postdetail);","map":{"version":3,"names":["React","useContext","useEffect","useState","AuthContext","Topbar","Post","useParams","styles","colors","withStyles","ArrowBackIcon","useMediaQuery","axios","useLocation","Link","LoadingBar","useHistory","COLORS","TimeMe","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Postdetail","_ref","classes","history","state","console","log","postObj","setPostObj","myObj","selectedValue","setSelectedValue","isMobileDevice","query","isTabletDevice","shouldSendEvent","setShouldSendEvent","user","currentUser","dispatch","username","PF","process","env","REACT_APP_PUBLIC_FOLDER","progress","setProgress","token","localStorage","getItem","handleReadChange","put","_id","postId","headers","updateStatus_State","res","get","concat","data","error","handleActivityRecorder","page","seconds","getTimeOnCurrentPageInSeconds","initialize","currentPageName","idleTimeoutInSeconds","callWhenUserLeaves","callWhenUserReturns","children","isProfile","style","showRefreshIcon","className","feed","feedWrapper","textDecoration","color","textColor","onClick","goBack","post","isDetail"],"sources":["/home/group4/TWON_STA_Case_Study/client/src/pages/postDetail/Postdetail.js"],"sourcesContent":["import React from 'react';\nimport { useContext, useEffect, useState } from \"react\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport Topbar from \"../../components/topbar/Topbar\";\nimport Post from \"../../components/post/Post\";\nimport { useParams } from 'react-router';\nimport {styles} from './PostdetailStyle';\nimport { colors } from '@material-ui/core';\nimport { withStyles } from '@material-ui/core/styles';\nimport ArrowBackIcon from '@mui/icons-material/ArrowBack';\nimport { useMediaQuery } from 'react-responsive';\nimport axios from \"axios\";\nimport { useLocation } from 'react-router-dom';\nimport { Link } from 'react-router-dom';\nimport LoadingBar from \"react-top-loading-bar\";\nimport { useHistory } from \"react-router\";\nimport {COLORS} from '../../components/values/colors.js';\n//import User from '../../../../server/models/User';\nimport TimeMe from \"timeme.js\";\n\nfunction Postdetail({ classes }) {\n  const history = useHistory();\n  const {state} = useLocation();\n  console.log(state);\n  const [postObj, setPostObj] = useState(state?.myObj || {});\n  const [selectedValue, setSelectedValue] = useState('0');\n  const isMobileDevice = useMediaQuery({ query: \"(min-device-width: 480px)\"});\n  const isTabletDevice = useMediaQuery({ query: \"(min-device-width: 768px)\"});\n  const [shouldSendEvent, setShouldSendEvent] = useState(false);\n\n  const { user: currentUser, dispatch } = useContext(AuthContext);\n  const username = useParams().username;\n  const PF = process.env.REACT_APP_PUBLIC_FOLDER;\n  const [progress, setProgress] = useState(0);\n\n  const token = localStorage.getItem('token');\n  const handleReadChange = () => {\n    axios.put(\"/users/\" + currentUser._id + \"/read\", { postId: state.myObj._id, headers: { 'auth-token': token } });\n};\n\nconst updateStatus_State = async () => {\n  try {\n    // Fetch the post by its ID\n    setProgress(30);\n    const res = await axios.get(`/posts/${postObj._id}`, {\n      headers: { \"auth-token\": token },\n    });\n\n    console.log(\"Fetched post data:\", res.data);\n    setPostObj(res.data); // Update state with the fetched post\n    setProgress(100);\n  } catch (error) {\n    console.error(\"Error fetching post:\", error);\n    setProgress(100);\n  }\n};\n\n\nconst handleActivityRecorder = () => {\n  axios.put(\"/users/\" + currentUser._id + \"/activity\", { page: \"DetailPage\", seconds: TimeMe.getTimeOnCurrentPageInSeconds(), headers: { 'auth-token': token } });\n};\n\n  useEffect(() => {\n    updateStatus_State();\n  \n    }, [username]);\n\n    useEffect(() => {\n      TimeMe.initialize({\n        currentPageName: \"DetailPage\", // current page\n        idleTimeoutInSeconds: 10 // seconds\n        });\n    \n        TimeMe.callWhenUserLeaves(() => {\n        setShouldSendEvent(true);\n        //handleActivityRecorder();\n        //handleReadChange();\n        });\n      \n        TimeMe.callWhenUserReturns(() => {\n        setShouldSendEvent(false);\n        });\n    \n      }, []);\n\n    /*useEffect(() => {\n      TimeMe.initialize({\n        currentPageName: \"PostDetailPage\", // current page\n        idleTimeoutInSeconds: 15 // seconds\n        });\n    \n        TimeMe.callWhenUserLeaves(() => {\n        setShouldSendEvent(true);\n        });\n      \n        TimeMe.callWhenUserReturns(() => {\n        setShouldSendEvent(false);\n        });\n    \n      }, []);*/\n\n  return (\n    <>\n        <Topbar isProfile=\"true\" setSelectedValue={setSelectedValue} style={{ 'margin-top': '-20px' }}  showRefreshIcon={true}/>\n        <div className={classes.feed}>\n            <div className={classes.feedWrapper}>\n            <Link style={{textDecoration: 'none', color: COLORS.textColor}}><ArrowBackIcon onClick={() => history.goBack()}/></Link>\n              <Post key={postObj._id} post={postObj} isDetail={true}/>\n            </div>\n        </div>\n    </>\n)\n}\n\nexport default withStyles(styles)(Postdetail);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
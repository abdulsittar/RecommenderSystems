{"ast":null,"code":"import React from'react';import{useContext}from'react';import{useState,useEffect}from'react';import{loginCall}from'../../apiCalls';import{useHistory}from\"react-router\";import{AuthContext}from'../../context/AuthContext';import{CircularProgress}from\"@material-ui/core\";import{withStyles}from'@material-ui/core/styles';import{styles}from'./loginPageStyle';import{useLocation}from'react-router-dom';import{Link}from'react-router-dom';import TextField from'@material-ui/core/TextField';import TimeMe from\"timeme.js\";import axios from\"axios\";import{useParams}from'react-router';import{disclaim}from'../../constants';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Login(_ref){let{classes}=_ref;const PF=process.env.REACT_APP_PUBLIC_FOLDER;const{user,isFetching,error,dispatch}=useContext(AuthContext);const history=useHistory();const{state}=useLocation();const[uniqId,setUniqId]=useState('');const[passwordErr,setPasswordErr]=useState('');const[shouldSendEvent,setShouldSendEvent]=useState(false);const t=new Date().getTime();console.log(TimeMe.getTimeOnCurrentPageInSeconds());const userId=useParams().userId;const[profPic,setProfPic]=useState(\"\");const[usrname,setUsrname]=useState(\"\");/*useEffect(() => {\n\tTimeMe.initialize({\n\t\tcurrentPageName: \"Login\", // current page\n\t\tidleTimeoutInSeconds: 15 // seconds\n\t  });\n\n\t  TimeMe.callWhenUserLeaves(() => {\n\t\tsetShouldSendEvent(true);\n\t  });\n  \n\t  TimeMe.callWhenUserReturns(() => {\n\t\tsetShouldSendEvent(false);\n\t  });\n\n  }, []); */const handleClick=e=>{e.preventDefault();//const email = document.getElementById('email').value;\nconst password=document.getElementById('password').value;const username=usrname;//if (email == password) {\n//\tsetPasswordErr(\"Check you password and email again!\");\n//}\nloginCall({username:username,password:password},dispatch);if(error==true){setPasswordErr(\"Check you password and email again!\");}//console.log(error);\nif(error==false){history.push(\"/\");}};const getUser=async uniqId=>{const token=localStorage.getItem('token');try{const res=await axios.post(\"/users/getUser/\".concat(uniqId),{headers:{'auth-token':token}});console.log(res.data.login);console.log(res.data.user);if(res.data.login==true){const user3=res.data.user;setProfPic(user3.profilePicture);setUsrname(user3.username);}}catch(err){console.log(err);}};useEffect(()=>{console.log(\"id\");console.log(userId);const urlParts=window.location.pathname.split('/');const valu=urlParts[urlParts.length-1];console.log(valu);setUniqId(userId);getUser(userId);},[]);return/*#__PURE__*/_jsx(\"div\",{className:classes.login,children:/*#__PURE__*/_jsxs(\"form\",{className:classes.form,noValidate:true,autoComplete:\"off\",onSubmit:handleClick,children:[/*#__PURE__*/_jsx(\"h1\",{className:classes.header,children:\"Log In\"}),/*#__PURE__*/_jsx(\"p\",{className:classes.text,children:\" \"}),/*#__PURE__*/_jsx(\"p\",{className:classes.disclaimor,children:disclaim}),/*#__PURE__*/_jsx(\"div\",{className:classes.label,children:/*#__PURE__*/_jsx(\"label\",{children:/*#__PURE__*/_jsxs(\"span\",{style:{\"margin-left\":\"0.5rem\",\"margin-top\":\"0.5rem\"},children:[/*#__PURE__*/_jsx(\"img\",{width:\"50\",height:\"50\",className:classes.profileCoverImg,src:profPic?PF+profPic:PF+\"person/noCover.png\",alt:\"\"}),\" \"+usrname]})})}),/*#__PURE__*/_jsx(TextField,{className:classes.textField,id:\"password\",label:\"Password\",type:\"password\"//autoComplete=\"current-password\"\n,required:true,minLength:\"6\"}),/*#__PURE__*/_jsx(\"p\",{className:classes.errorMessage,children:passwordErr}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:classes.button,children:\"Log In\"})]})});}export default withStyles(styles)(Login);","map":{"version":3,"names":["React","useContext","useState","useEffect","loginCall","useHistory","AuthContext","CircularProgress","withStyles","styles","useLocation","Link","TextField","TimeMe","axios","useParams","disclaim","jsx","_jsx","jsxs","_jsxs","Login","_ref","classes","PF","process","env","REACT_APP_PUBLIC_FOLDER","user","isFetching","error","dispatch","history","state","uniqId","setUniqId","passwordErr","setPasswordErr","shouldSendEvent","setShouldSendEvent","t","Date","getTime","console","log","getTimeOnCurrentPageInSeconds","userId","profPic","setProfPic","usrname","setUsrname","handleClick","e","preventDefault","password","document","getElementById","value","username","push","getUser","token","localStorage","getItem","res","post","concat","headers","data","login","user3","profilePicture","err","urlParts","window","location","pathname","split","valu","length","className","children","form","noValidate","autoComplete","onSubmit","header","text","disclaimor","label","style","width","height","profileCoverImg","src","alt","textField","id","type","required","minLength","errorMessage","button"],"sources":["/home/group4/TWON_STA_Case_Study/client/src/pages/login/Login.js"],"sourcesContent":["import React from 'react';\nimport { useContext } from 'react';\nimport { useState, useEffect } from 'react';\nimport {loginCall} from '../../apiCalls';\nimport { useHistory } from \"react-router\";\nimport { AuthContext } from '../../context/AuthContext';\nimport { CircularProgress } from \"@material-ui/core\";\nimport { withStyles } from '@material-ui/core/styles';\nimport {styles} from './loginPageStyle';\nimport { useLocation } from 'react-router-dom';\nimport { Link } from 'react-router-dom';\nimport TextField from '@material-ui/core/TextField';\nimport TimeMe from \"timeme.js\";\nimport axios from \"axios\";\nimport { useParams } from 'react-router';\nimport { disclaim} from '../../constants';\n\n\nfunction Login({ classes }) {\n  const PF = process.env.REACT_APP_PUBLIC_FOLDER;\n  const {user, isFetching, error, dispatch} = useContext(AuthContext);\n  const history = useHistory();\n  const {state} = useLocation();\n  const [uniqId, setUniqId] = useState('');\n  const [passwordErr, setPasswordErr] = useState('');\n  const [shouldSendEvent, setShouldSendEvent] = useState(false);\n  const t = new Date().getTime();\n  console.log(TimeMe.getTimeOnCurrentPageInSeconds());\n  const userId = useParams().userId;\n  const [profPic, setProfPic] = useState(\"\");\n\n  const [usrname, setUsrname] = useState(\"\");\n\n  /*useEffect(() => {\n\tTimeMe.initialize({\n\t\tcurrentPageName: \"Login\", // current page\n\t\tidleTimeoutInSeconds: 15 // seconds\n\t  });\n\n\t  TimeMe.callWhenUserLeaves(() => {\n\t\tsetShouldSendEvent(true);\n\t  });\n  \n\t  TimeMe.callWhenUserReturns(() => {\n\t\tsetShouldSendEvent(false);\n\t  });\n\n  }, []); */\n\n  const handleClick = (e) => {\n\te.preventDefault();\n\t//const email = document.getElementById('email').value;\n\tconst password = document.getElementById('password').value;\n\tconst username =  usrname;\n\n\t//if (email == password) {\n\t//\tsetPasswordErr(\"Check you password and email again!\");\n\t//}\n    loginCall({ username: username, password: password }, dispatch);\n\tif(error == true){\n\t\tsetPasswordErr(\"Check you password and email again!\");\n\t}\n\t//console.log(error);\n\tif(error == false){history.push(\"/\");}\n\t\n  };\n\n  const getUser = async (uniqId) => {\n\tconst token = localStorage.getItem('token');\n\ttry {\n\t\tconst res = await axios.post(`/users/getUser/${uniqId}`,{ headers: { 'auth-token': token }}); \n\t\tconsole.log(res.data.login);\n\t\tconsole.log(res.data.user);\n\t\n\t\tif(res.data.login == true){\n\t\t\tconst user3 = res.data.user;\n\t\t\tsetProfPic(user3.profilePicture);\n\t\t\tsetUsrname(user3.username);\n\t\t}\n\t  } catch (err) {\n\t\tconsole.log(err);  \n\t  }\n\t};\n\n  useEffect(() => {\n\tconsole.log(\"id\");\n\tconsole.log(userId);\n\tconst urlParts = window.location.pathname.split('/');\n    const valu = urlParts[urlParts.length-1]\n    console.log(valu);\n    setUniqId(userId);\n\tgetUser(userId);\n\n\t\t}, []);\n\n    return (\n\t\t  <div className={classes.login} >\n\t\t\t\t<form className={classes.form} noValidate autoComplete=\"off\" onSubmit={handleClick}>\n\t\t\t\t\t<h1 className={classes.header}>Log In</h1>\n\t\t\t\t\t{ /*<p className={classes.text}>new to this app? <Link  style={{textDecoration: 'none'}} to={\"/register/\" + userId} >sign up for free</Link></p>*/ }\n\t\t\t\t\t<p className={classes.text}> </p>\n\t\t\t\t\t<p className={classes.disclaimor}>{disclaim}</p> \n\t\t\t\t\t{ /*<TextField \n\t\t\t\t\t\tclassName={classes.textField}\t\t\t\t\t\t\n\t\t\t\t\t\tid='email' \n\t\t\t\t\t\tname='email' \n\t\t\t\t\t\tlabel=\"Email\" \n\t\t\t\t\t\trequired \t\n\t\t\t\t\t\ttype=\"email\"\n\t\t\t\t\t/>*/ }\n\t\t\t\t\t{ /*<p className={classes.errorMessage}>err email</p>*/ }\n\t\t\t\t\t<div className={classes.label}><label ><span style={{\"margin-left\": \"0.5rem\", \"margin-top\": \"0.5rem\"}}><img width=\"50\" height=\"50\" className={classes.profileCoverImg}  src={profPic ? PF+profPic : PF+\"person/noCover.png\"} alt=\"\" />{\" \"+ usrname}</span></label></div>\n        \n\t\t\t\t\t<TextField\n\t\t\t\t\t\tclassName={classes.textField}\n\t\t\t\t\t\tid=\"password\"\n\t\t\t\t\t\tlabel=\"Password\"\n\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t//autoComplete=\"current-password\"\n\t\t\t\t\t\trequired\n\t\t\t\t\t\tminLength=\"6\"\n\t\t\t\t\t/>\n\t\t\t\t\t{ <p className={classes.errorMessage}>{passwordErr}</p>}\n\t\t\t\t\t<button type=\"submit\" className={classes.button}>Log In</button>\n\t\t\t\t</form>\n\t\t</div>\n\n    )\n}\n\nexport default withStyles(styles)(Login);"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}